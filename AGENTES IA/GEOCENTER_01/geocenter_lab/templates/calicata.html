{% extends "base.html" %}

{% block header %}Modo Calicata - Ingreso Unificado{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">

    <!-- Header -->
    <div class="mb-6 bg-gradient-to-r from-blue-600 to-indigo-700 rounded-xl p-6 text-white shadow-lg">
        <div class="flex justify-between items-center">
            <div>
                <h2 class="text-2xl font-bold">üìã Modo Calicata Unificado</h2>
                <p class="text-blue-100 mt-1">Ingresa todos los datos de laboratorio y calcula todos los ensayos con un
                    solo clic</p>
            </div>
            <div class="flex gap-3">
                <button onclick="loadSampleData()"
                    class="bg-yellow-400 text-yellow-900 px-4 py-3 rounded-xl font-bold hover:bg-yellow-300 transition-all shadow-lg flex items-center gap-2">
                    üì• Cargar Ejemplo
                </button>
                <button onclick="calculateAll()"
                    class="bg-white text-blue-600 px-6 py-3 rounded-xl font-bold text-lg hover:bg-blue-50 transition-all shadow-lg flex items-center gap-2">
                    ‚ö° CALCULAR TODO
                </button>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

        <!-- LEFT: Data Entry -->
        <div class="lg:col-span-2 space-y-4">

            <!-- Project Info -->
            <div class="bg-white rounded-xl shadow border border-gray-100 overflow-hidden">
                <div class="bg-gray-50 px-4 py-3 border-b flex justify-between items-center cursor-pointer"
                    onclick="toggleSection('project')">
                    <h3 class="font-bold text-gray-700">üìÅ Datos del Proyecto</h3>
                    <span id="arrow-project" class="text-gray-400">‚ñº</span>
                </div>
                <div id="section-project" class="p-4 grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Cliente</label>
                        <input type="text" id="client" class="w-full border rounded-lg p-2"
                            value="MUNICIPALIDAD DISTRITAL">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Proyecto</label>
                        <input type="text" id="project" class="w-full border rounded-lg p-2"
                            value="MEJORAMIENTO DE VIA">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Calicata</label>
                        <input type="text" id="calicataId" class="w-full border rounded-lg p-2" value="C-01">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Profundidad (m)</label>
                        <input type="number" id="depth" step="0.01" class="w-full border rounded-lg p-2" value="1.50">
                    </div>
                </div>
            </div>

            <!-- Granulometry -->
            <div class="bg-white rounded-xl shadow border border-gray-100 overflow-hidden">
                <div class="bg-blue-50 px-4 py-3 border-b flex justify-between items-center cursor-pointer"
                    onclick="toggleSection('granulometry')">
                    <h3 class="font-bold text-blue-700">üî¨ Granulometr√≠a</h3>
                    <span id="arrow-granulometry" class="text-blue-400">‚ñº</span>
                </div>
                <div id="section-granulometry" class="p-4">
                    <div class="mb-4">
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Peso Total Muestra Seca
                            (gr)</label>
                        <input type="number" id="gran-total" class="w-48 border rounded-lg p-2" placeholder="5000">
                    </div>
                    <table class="w-full text-sm">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="p-2 text-left">Tamiz</th>
                                <th class="p-2">Abertura (mm)</th>
                                <th class="p-2">Masa Ret. (gr)</th>
                            </tr>
                        </thead>
                        <tbody id="gran-sieves">
                            <!-- Generated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Limits -->
            <div class="bg-white rounded-xl shadow border border-gray-100 overflow-hidden">
                <div class="bg-purple-50 px-4 py-3 border-b flex justify-between items-center cursor-pointer"
                    onclick="toggleSection('limits')">
                    <h3 class="font-bold text-purple-700">üìè L√≠mites de Atterberg</h3>
                    <span id="arrow-limits" class="text-purple-400">‚ñº</span>
                </div>
                <div id="section-limits" class="p-4 space-y-4">
                    <!-- Liquid Limit -->
                    <div>
                        <h4 class="font-semibold text-sm text-gray-600 mb-2">L√≠mite L√≠quido (LL)</h4>
                        <table class="w-full text-sm">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-2">Golpes</th>
                                    <th class="p-2">Tara (gr)</th>
                                    <th class="p-2">H√∫m+Tara</th>
                                    <th class="p-2">Seco+Tara</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="p-2"><input type="number" id="ll-blows-1"
                                            class="w-16 border rounded p-1 text-center" value="35"></td>
                                    <td class="p-2"><input type="number" id="ll-tare-1" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="ll-wet-1" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="ll-dry-1" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                </tr>
                                <tr class="border-b">
                                    <td class="p-2"><input type="number" id="ll-blows-2"
                                            class="w-16 border rounded p-1 text-center" value="28"></td>
                                    <td class="p-2"><input type="number" id="ll-tare-2" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="ll-wet-2" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="ll-dry-2" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                </tr>
                                <tr>
                                    <td class="p-2"><input type="number" id="ll-blows-3"
                                            class="w-16 border rounded p-1 text-center" value="18"></td>
                                    <td class="p-2"><input type="number" id="ll-tare-3" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="ll-wet-3" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="ll-dry-3" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- Plastic Limit -->
                    <div>
                        <h4 class="font-semibold text-sm text-gray-600 mb-2">L√≠mite Pl√°stico (LP)</h4>
                        <table class="w-full text-sm">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-2">Muestra</th>
                                    <th class="p-2">Tara (gr)</th>
                                    <th class="p-2">H√∫m+Tara</th>
                                    <th class="p-2">Seco+Tara</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="p-2 text-center">1</td>
                                    <td class="p-2"><input type="number" id="pl-tare-1" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="pl-wet-1" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="pl-dry-1" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                </tr>
                                <tr>
                                    <td class="p-2 text-center">2</td>
                                    <td class="p-2"><input type="number" id="pl-tare-2" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="pl-wet-2" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                    <td class="p-2"><input type="number" id="pl-dry-2" class="w-20 border rounded p-1"
                                            step="0.01"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Natural Moisture -->
            <div class="bg-white rounded-xl shadow border border-gray-100 overflow-hidden">
                <div class="bg-cyan-50 px-4 py-3 border-b flex justify-between items-center cursor-pointer"
                    onclick="toggleSection('moisture')">
                    <h3 class="font-bold text-cyan-700">üíß Humedad Natural</h3>
                    <span id="arrow-moisture" class="text-cyan-400">‚ñº</span>
                </div>
                <div id="section-moisture" class="p-4">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="p-2">Muestra</th>
                                <th class="p-2">Tara (gr)</th>
                                <th class="p-2">H√∫m+Tara</th>
                                <th class="p-2">Seco+Tara</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="p-2 text-center">1</td>
                                <td class="p-2"><input type="number" id="moist-tare-1" class="w-20 border rounded p-1"
                                        step="0.01"></td>
                                <td class="p-2"><input type="number" id="moist-wet-1" class="w-20 border rounded p-1"
                                        step="0.01"></td>
                                <td class="p-2"><input type="number" id="moist-dry-1" class="w-20 border rounded p-1"
                                        step="0.01"></td>
                            </tr>
                            <tr>
                                <td class="p-2 text-center">2</td>
                                <td class="p-2"><input type="number" id="moist-tare-2" class="w-20 border rounded p-1"
                                        step="0.01"></td>
                                <td class="p-2"><input type="number" id="moist-wet-2" class="w-20 border rounded p-1"
                                        step="0.01"></td>
                                <td class="p-2"><input type="number" id="moist-dry-2" class="w-20 border rounded p-1"
                                        step="0.01"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Direct Shear (simplified) -->
            <div class="bg-white rounded-xl shadow border border-gray-100 overflow-hidden">
                <div class="bg-red-50 px-4 py-3 border-b flex justify-between items-center cursor-pointer"
                    onclick="toggleSection('shear')">
                    <h3 class="font-bold text-red-700">‚úÇÔ∏è Corte Directo (Resumido)</h3>
                    <span id="arrow-shear" class="text-red-400">‚ñº</span>
                </div>
                <div id="section-shear" class="p-4">
                    <p class="text-sm text-gray-500 mb-3">Ingresa los resultados ya procesados de cada esp√©cimen:</p>
                    <table class="w-full text-sm">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="p-2">Esp√©cimen</th>
                                <th class="p-2">œÉ Normal (kg/cm¬≤)</th>
                                <th class="p-2">œÑ M√°ximo (kg/cm¬≤)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="p-2 text-center font-bold">1</td>
                                <td class="p-2"><input type="number" id="shear-sigma-1" class="w-24 border rounded p-1"
                                        step="0.01" value="0.5"></td>
                                <td class="p-2"><input type="number" id="shear-tau-1" class="w-24 border rounded p-1"
                                        step="0.01"></td>
                            </tr>
                            <tr class="border-b">
                                <td class="p-2 text-center font-bold">2</td>
                                <td class="p-2"><input type="number" id="shear-sigma-2" class="w-24 border rounded p-1"
                                        step="0.01" value="1.0"></td>
                                <td class="p-2"><input type="number" id="shear-tau-2" class="w-24 border rounded p-1"
                                        step="0.01"></td>
                            </tr>
                            <tr>
                                <td class="p-2 text-center font-bold">3</td>
                                <td class="p-2"><input type="number" id="shear-sigma-3" class="w-24 border rounded p-1"
                                        step="0.01" value="1.5"></td>
                                <td class="p-2"><input type="number" id="shear-tau-3" class="w-24 border rounded p-1"
                                        step="0.01"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

        <!-- RIGHT: Results Panel -->
        <div class="space-y-4">

            <!-- Status -->
            <div id="status-panel" class="bg-gray-100 rounded-xl p-4 text-center">
                <div class="text-gray-400 text-4xl mb-2">üìä</div>
                <p class="text-gray-500">Ingresa los datos y presiona <strong>"CALCULAR TODO"</strong></p>
            </div>

            <!-- Results Cards (hidden initially) -->
            <div id="results-panel" class="hidden space-y-3">

                <!-- SUCS Classification -->
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-4 text-white text-center">
                    <div class="text-xs uppercase tracking-wide opacity-70">Clasificaci√≥n SUCS</div>
                    <div id="res-sucs" class="text-4xl font-black">--</div>
                    <div id="res-sucs-name" class="text-sm opacity-80">--</div>
                </div>

                <!-- Key Parameters -->
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-blue-500">
                        <div class="text-xs text-gray-500">% Finos</div>
                        <div id="res-finos" class="text-xl font-bold">--</div>
                    </div>
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-purple-500">
                        <div class="text-xs text-gray-500">IP</div>
                        <div id="res-ip" class="text-xl font-bold">--</div>
                    </div>
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-green-500">
                        <div class="text-xs text-gray-500">œÜ (¬∞)</div>
                        <div id="res-phi" class="text-xl font-bold">--</div>
                    </div>
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-orange-500">
                        <div class="text-xs text-gray-500">c (kg/cm¬≤)</div>
                        <div id="res-c" class="text-xl font-bold">--</div>
                    </div>
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-cyan-500">
                        <div class="text-xs text-gray-500">LL</div>
                        <div id="res-ll" class="text-xl font-bold">--</div>
                    </div>
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-pink-500">
                        <div class="text-xs text-gray-500">LP</div>
                        <div id="res-lp" class="text-xl font-bold">--</div>
                    </div>
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-yellow-500">
                        <div class="text-xs text-gray-500">Humedad %</div>
                        <div id="res-moisture" class="text-xl font-bold">--</div>
                    </div>
                    <div class="bg-white rounded-xl shadow p-3 text-center border-l-4 border-red-500">
                        <div class="text-xs text-gray-500">Cu</div>
                        <div id="res-cu" class="text-xl font-bold">--</div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="space-y-2">
                    <a href="/reporte_print" target="_blank"
                        class="block w-full bg-green-600 hover:bg-green-700 text-white text-center py-3 rounded-xl font-bold transition-all">
                        üìÑ VER REPORTE COMPLETO
                    </a>
                    <button onclick="saveCalicata()"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-xl font-semibold transition-all">
                        üíæ Guardar en Base de Datos
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>

<script>
    // Sieve configuration
    const SIEVES = [
        { label: '3"', size: 75.0 },
        { label: '1 1/2"', size: 37.5 },
        { label: '3/4"', size: 19.0 },
        { label: '3/8"', size: 9.5 },
        { label: '# 4', size: 4.75 },
        { label: '# 8', size: 2.36 },
        { label: '# 16', size: 1.18 },
        { label: '# 30', size: 0.60 },
        { label: '# 50', size: 0.30 },
        { label: '# 100', size: 0.15 },
        { label: '# 200', size: 0.075 }
    ];

    function initSieveTable() {
        const tbody = document.getElementById('gran-sieves');
        tbody.innerHTML = SIEVES.map(s => `
            <tr class="border-b">
                <td class="p-2 font-medium">${s.label}</td>
                <td class="p-2 text-gray-500 text-center">${s.size}</td>
                <td class="p-2"><input type="number" step="0.01" class="gran-input w-24 border rounded p-1" data-size="${s.label}" data-mm="${s.size}"></td>
            </tr>
        `).join('');
    }

    function toggleSection(name) {
        const section = document.getElementById('section-' + name);
        const arrow = document.getElementById('arrow-' + name);
        section.classList.toggle('hidden');
        arrow.textContent = section.classList.contains('hidden') ? '‚ñ∂' : '‚ñº';
    }

    async function calculateAll() {
        const statusPanel = document.getElementById('status-panel');
        const resultsPanel = document.getElementById('results-panel');

        statusPanel.innerHTML = '<div class="text-blue-500 text-4xl animate-spin mb-2">‚è≥</div><p class="text-blue-600">Calculando todos los ensayos...</p>';

        try {
            // 1. Granulometry
            const granData = {
                total_dry_weight: parseFloat(document.getElementById('gran-total').value) || 0,
                sieves: []
            };
            document.querySelectorAll('.gran-input').forEach(input => {
                granData.sieves.push({
                    size_label: input.dataset.size,
                    opening_mm: parseFloat(input.dataset.mm),
                    weight_retained: parseFloat(input.value) || 0
                });
            });
            const granRes = await fetch('/granulometria', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(granData)
            });
            const granResult = await granRes.json();

            // 2. Limits - Use field names expected by limits.py
            const limitsData = {
                ll_data: [1, 2, 3].map(i => ({
                    blows: parseFloat(document.getElementById(`ll-blows-${i}`).value) || 0,
                    tare: parseFloat(document.getElementById(`ll-tare-${i}`).value) || 0,
                    wet_tare: parseFloat(document.getElementById(`ll-wet-${i}`).value) || 0,
                    dry_tare: parseFloat(document.getElementById(`ll-dry-${i}`).value) || 0
                })),
                pl_data: [1, 2].map(i => ({
                    tare: parseFloat(document.getElementById(`pl-tare-${i}`).value) || 0,
                    wet_tare: parseFloat(document.getElementById(`pl-wet-${i}`).value) || 0,
                    dry_tare: parseFloat(document.getElementById(`pl-dry-${i}`).value) || 0
                }))
            };
            const limitsRes = await fetch('/limites', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(limitsData)
            });
            const limitsResult = await limitsRes.json();

            // 3. Moisture - Use field names expected by moisture.py
            const moistureData = {
                samples: [1, 2].map(i => ({
                    tare: parseFloat(document.getElementById(`moist-tare-${i}`).value) || 0,
                    wet_tare: parseFloat(document.getElementById(`moist-wet-${i}`).value) || 0,
                    dry_tare: parseFloat(document.getElementById(`moist-dry-${i}`).value) || 0
                }))
            };
            const moistRes = await fetch('/humedad', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(moistureData)
            });
            const moistResult = await moistRes.json();

            // 4. Direct Shear - Use field names expected by shear.py
            const shearData = {
                specimens: [1, 2, 3].map(i => ({
                    normal_stress: parseFloat(document.getElementById(`shear-sigma-${i}`).value) || 0,
                    shear_stress_max: parseFloat(document.getElementById(`shear-tau-${i}`).value) || 0
                }))
            };
            const shearRes = await fetch('/corte', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(shearData)
            });
            const shearResult = await shearRes.json();

            // 5. Auto Classification
            const classRes = await fetch('/auto_classify', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({})
            });
            const classResult = await classRes.json();

            // Update UI
            statusPanel.classList.add('hidden');
            resultsPanel.classList.remove('hidden');

            // Populate results - Debug log
            console.log('Granulometry result:', granResult);
            console.log('Limits result:', limitsResult);
            console.log('Moisture result:', moistResult);
            console.log('Shear result:', shearResult);
            console.log('Classification result:', classResult);

            // SUCS Classification
            document.getElementById('res-sucs').textContent = classResult.symbol || '--';
            document.getElementById('res-sucs-name').textContent = classResult.name || '--';

            // Granulometry metrics
            if (granResult.metrics) {
                // The backend returns 'fractions.fines' not 'fines_percent'
                const fines = granResult.metrics.fractions?.fines ?? granResult.metrics.fines_percent;
                document.getElementById('res-finos').textContent = fines ? fines.toFixed(2) + '%' : '--';
                document.getElementById('res-cu').textContent = granResult.metrics.cu ?? '--';
            }

            // Atterberg Limits - Backend returns LL, PL, PI (not LP!)
            if (limitsResult.results) {
                document.getElementById('res-ll').textContent = limitsResult.results.LL ? limitsResult.results.LL.toFixed(2) + '%' : '--';
                document.getElementById('res-lp').textContent = limitsResult.results.PL ? limitsResult.results.PL.toFixed(2) + '%' : '--';
                document.getElementById('res-ip').textContent = limitsResult.results.PI ? limitsResult.results.PI.toFixed(2) + '%' : '--';
            }

            // Moisture - Backend returns 'average' not 'average_moisture'
            if (moistResult.results) {
                document.getElementById('res-moisture').textContent = moistResult.results.average ? moistResult.results.average + '%' : '--';
            }

            // Shear results
            if (shearResult.results) {
                document.getElementById('res-phi').textContent = shearResult.results.friction_angle ? shearResult.results.friction_angle + '¬∞' : '--';
                document.getElementById('res-c').textContent = shearResult.results.cohesion ?? '--';
            }

        } catch (e) {
            console.error('Error en calculateAll:', e);
            statusPanel.innerHTML = '<div class="text-red-500 text-4xl mb-2">‚ùå</div><p class="text-red-600">Error al calcular. Ver consola.</p>';
        }
    }

    async function saveCalicata() {
        const data = {
            project: document.getElementById('project').value,
            calicata: document.getElementById('calicataId').value
        };
        const res = await fetch('/save_results', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        const result = await res.json();
        if (result.success) {
            alert('‚úÖ Calicata guardada correctamente');
        } else {
            alert('‚ùå Error al guardar');
        }
    }

    // Load sample data for quick testing (from ENSAYOS.xlsx)
    function loadSampleData() {
        // Project Info
        document.getElementById('client').value = 'MUNICIPALIDAD DISTRITAL DE SAN MARCOS';
        document.getElementById('project').value = 'MEJORAMIENTO Y AMPLIACION DEL SERVICIO DE TRANSITABILIDAD';
        document.getElementById('calicataId').value = 'C-01';
        document.getElementById('depth').value = '1.50';

        // Granulometry - total weight
        document.getElementById('gran-total').value = '2560';

        // Granulometry - sieve masses (from ENSAYOS.xlsx)
        const sieveMasses = {
            '3"': 0,
            '1 1/2"': 0,
            '3/4"': 0,
            '3/8"': 0,
            '# 4': 0,
            '# 8': 125.80,
            '# 16': 203.60,
            '# 30': 142.20,
            '# 50': 95.60,
            '# 100': 65.60,
            '# 200': 20.30
        };
        document.querySelectorAll('.gran-input').forEach(input => {
            const label = input.dataset.size;
            if (sieveMasses[label] !== undefined) {
                input.value = sieveMasses[label];
            }
        });

        // Liquid Limit data (3 points)
        document.getElementById('ll-blows-1').value = '35';
        document.getElementById('ll-tare-1').value = '27.50';
        document.getElementById('ll-wet-1').value = '42.30';
        document.getElementById('ll-dry-1').value = '38.20';

        document.getElementById('ll-blows-2').value = '28';
        document.getElementById('ll-tare-2').value = '28.10';
        document.getElementById('ll-wet-2').value = '43.80';
        document.getElementById('ll-dry-2').value = '39.00';

        document.getElementById('ll-blows-3').value = '18';
        document.getElementById('ll-tare-3').value = '27.80';
        document.getElementById('ll-wet-3').value = '45.50';
        document.getElementById('ll-dry-3').value = '39.80';

        // Plastic Limit data (2 samples)
        document.getElementById('pl-tare-1').value = '27.20';
        document.getElementById('pl-wet-1').value = '32.50';
        document.getElementById('pl-dry-1').value = '31.40';

        document.getElementById('pl-tare-2').value = '27.80';
        document.getElementById('pl-wet-2').value = '33.10';
        document.getElementById('pl-dry-2').value = '31.90';

        // Moisture data (2 samples)
        document.getElementById('moist-tare-1').value = '28.50';
        document.getElementById('moist-wet-1').value = '85.30';
        document.getElementById('moist-dry-1').value = '81.80';

        document.getElementById('moist-tare-2').value = '29.10';
        document.getElementById('moist-wet-2').value = '88.60';
        document.getElementById('moist-dry-2').value = '84.90';

        // Direct Shear (3 specimens)
        document.getElementById('shear-sigma-1').value = '0.50';
        document.getElementById('shear-tau-1').value = '0.27';

        document.getElementById('shear-sigma-2').value = '1.00';
        document.getElementById('shear-tau-2').value = '0.50';

        document.getElementById('shear-sigma-3').value = '1.50';
        document.getElementById('shear-tau-3').value = '0.73';

        alert('‚úÖ Datos de ejemplo cargados. Presiona "CALCULAR TODO" para ver resultados.');
    }

    // Initialize
    initSieveTable();
</script>
{% endblock %}